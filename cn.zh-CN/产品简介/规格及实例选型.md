# 规格及实例选型 {#concept_mp2_hbr_52b .concept}

本文将介绍如何选择分析型数据库 PostgreSQL版实例规格。

## 实例规格定义 {#section_jtc_h9i_if8 .section}

分析型数据库PostgreSQL版实例的规格由下列参数决定

-   **存储类型** 

    该参数用于决定存储介质是SSD还是HDD，两种存储类型区别如下：

    -   **SSD**：可以提供更好的 I/O能力，带来更高的分析性能。
    -   **HDD**：可以提供更大、更实惠的空间，满足更高的存储需求。
-   **SSD 存储单节点规格** 

    SSD 存储单节点可选核数配置为 **1** 或**4**。 **单节点4核为主要推荐规格，单节点1核规格只适合低并发执行场景，或节点数小于32的实例场景**。

    -   SSD 单节点1核配置，含8GB 内存/ 80GB 有效存储空间/ 160GB 双副本总存储空间
    -   SSD 单节点4核配置，含32GB 内存/ 320GB 有效存储空间/ 640GB 双副本总存储空间
-   **D 存储单节点规格** 

    SSD 存储单节点可选核数配置为 **2** 或**4**。 **单节点4核为主要推荐规格，单节点2核规格只适合低并发执行场景，或节点数小于8的实例场景**。

    -   HDD 单节点2核配置，含16GB 内存/ 1TB 有效存储空间/ 2TB 双副本总存储空间
    -   HDD 单节点4核配置，含32GB 内存/ 2TB 有效存储空间/ 4TB 双副本总存储空间
-   **实例节点数** 

    一个实例由多个节点组成，最多支持1024个，每个节点存储并处理一部分数据。MPP 架构下，存储空间随节点数线性增加，而查询响应时间 RT 不变。


**说明：** 关于产品价格，请参见[产品定价](../../../../cn.zh-CN/产品定价/产品定价.md#)。

## 实例配置选型原则 {#section_bh8_zcf_8cg .section}

分析型数据库PostgreSQL版在创建或升级实例规格时，需要选择实例的**存储类型**，**单节点核数**和**实例节点数**。分析型数据库PostgreSQL版也支持OSS外部表的扩展，可通过gzip实现外部存储上的数据压缩，将不需要参与实时计算的数据存储到数据库外部以进一步节省存储成本。

-   **存储类型选择** 
    -   对于性能优先类场景，建议以SSD构建分析数据仓库实例；
    -   对于以数据存储类优先的场景，可以考虑 HDD类型。
-   **单节点核数选择** 

    每个节点会存储并处理每个用户表其中一个分片的数据，单节点的核数越多，并发支持越好，同时内存、存储资源也越多。

-   **实例节点数选择** 

    分析型数据库PostgreSQL版采用MPP全并行架构，数据处理能力随实例节点数量增加而线性增长，保证数据量增加而响应RT时间不变。可以参照原始数据量及应用场景，选择适合的实例节点数。


**行存储与列存储的选择**

-   有较多数据更新操作或有实时写入的业务场景 （INSERT/UPDATE/DELETE ），建议采用行存储。

    对于1TB 原始数据，入库后采用行存储，大小一般还是在 1TB左右，考虑到索引、日志、以及在计算过程中会产生临时文件等，建议按2TB的用户数据空间来规划集群实例规格。若对查询性能要求较高，可以增加实例节点数，从而增加相应的CPU、内存等资源，提升查询性能。

-   批处理ETL场景，其数据一般较少被更新（UPDATE/DELETE），数据为批量入库，同时查询以少量列的全表数据聚合关联为主，建议采用列存储。

    列存储支持较高的数据压缩率，可以达到 2-5倍的压缩比，即对于1TB原始数据，入库后若采用了列存储压缩设置，数据在0.5TB以内，那么可以按 1TB的用户数据存储空间来规划集群实例规格。


## 实例配置选型示例 {#section_qrm_7gd_mpf .section}

如果有5TB的原始数据，针对高性能分析场景，并有100并发以上的查询，建议采用SSD存储类型，单节点4核，32个节点实例规格，那么将总计有 10TB 用户数据存储空间。

