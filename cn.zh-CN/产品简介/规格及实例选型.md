# 规格及实例选型 {#concept_mp2_hbr_52b .concept}

本文将介绍如何选择分析型数据库PostgreSQL版实例规格。

## 实例规格定义 {#section_jtc_h9i_if8 .section}

分析型数据库PostgreSQL版实例的规格由下列参数决定

-   **存储类型** 

    该参数用于决定存储介质是SSD还是HDD，两种存储类型区别如下：

    -   SSD：可以提供更好的 I/O能力，带来更高的分析性能。
    -   HDD：可以提供更大、更实惠的空间，满足更高的存储需求。
-   **单节点核数** 

    该参数决定了实例中每个节点的CPU核数，核数越多，对查询写入的并发支持能力越强。可选项如下：

    -   1
    -   4
    内存和存储资源由核数来决定：

    -   SSD：每核对应8GB内存，80GB可用存储（实际双副本160GB）。
    -   HDD：每核对应8GB内存，500GB可用存储（实际双副本1TB）。
-   **实例节点数** 

    一个实例由多个节点组成，每个节点存储并处理一部分数据，节点越多，在MPP计算形态下，对单个查询的响应越快。可选项如下：

    -   4
    -   8
    -   12
    -   16
    -   24
    -   32
    -   64
    -   96
    -   128
    **说明：** 

    -   单节点4核在多种场景有较好的适配性，为主要推荐的规格。
    -   单节点1核，只适合低并发执行场景，例如5并发以下的简单查询（3表以内关联），可以使用单节点1核。

**说明：** 关于产品价格，请参见[产品定价](../../../../cn.zh-CN/产品定价/产品定价.md#)。

## 实例选型指导 {#section_bh8_zcf_8cg .section}

分析型数据库PostgreSQL版在创建或升级实例规格时，需要选择实例的**存储类型**，**单节点核数**和**实例节点数**。同时，分析型数据库PostgreSQL版支持OSS外部表的扩展，可通过gzip实现外部存储上的数据压缩，将不需要参与实时计算的数据存储到数据库外部以进一步节省存储成本。

-   **存储类型选择** 
    -   对于性能优先类场景，建议以SSD构建分析数据仓库实例；
    -   对于以数据存储类优先的场景，可以考虑 HDD类型。
-   **单节点核数选择** 

    每个节点会存储并处理每张用户表其中一个分片的数据，单节点的核数越多，并发支持越好，同时内存、存储资源也越多。

-   **实例节点数选择** 

    分析型数据库PostgreSQL版采用MPP全并行架构，数据处理能力随实例节点数量增加而线性增长，保证数据量增加而响应RT时间不变。可以参照原始数据量及应用场景，选择适合的实例节点数。


**行存储与列存储的选择**

-   有较多数据更新操作或有实时写入的业务场景 （INSERT/UPDATE/DELETE ），建议采用行存储。

    对于1TB 原始数据，入库后采用行存储，大小一般还是在 1TB左右，考虑到索引、日志、以及在计算过程中会产生临时文件等，建议按2TB的用户数据空间来规划集群实例规格。若对查询性能要求较高，可以增加实例节点数，从而增加相应的CPU、内存等资源，提升查询性能。

-   批处理ETL场景，其数据一般较少被更新（UPDATE/DELETE），数据为批量入库，同时查询以少量列的全表数据聚合关联为主，建议采用列存储。

    列存储具备较高的数据压缩率，可以达到 2-5倍的压缩比，即对于1TB原始数据，入库后若采用了列存储压缩设置，数据在0.5TB以内，那么可以按 1TB的用户数据存储空间来规划集群实例规格。


## 实例选型示例 {#section_qrm_7gd_mpf .section}

如果有5TB的原始数据，针对高性能分析场景，并有100并发以上的查询，建议采用SSD存储类型，单节点4核，32节点实例规格，总计10TB用户数据存储空间。

